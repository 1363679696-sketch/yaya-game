<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>ä¼¢ç‰™ä¹é˜²è›€å†’é™©å²›</title>
    <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:"å¾®è½¯é›…é»‘","Helvetica",sans-serif;}
    body{
      background:linear-gradient(135deg,#fdf2ff 0%,#e0f2fe 35%,#020617 100%);
      color:#fff;
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
    }
    #game{
      width:100%;
      max-width:1100px;
      height:90vh;
      background:radial-gradient(circle at top,#1e1b4b,#020617);
      border-radius:20px;
      box-shadow:0 0 35px rgba(15,23,42,.9);
      overflow:hidden;
      position:relative;
    }
    .screen{
  display:none;
  width:100%;
  height:100%;
  padding:18px 22px;
  position:absolute;
  top:0;
  left:0;
}

/* æ‰€æœ‰é¡µé¢ç»Ÿä¸€ç”¨çºµå‘ flex å¸ƒå±€ */
.screen.active{
  display:flex;
  flex-direction:column;
}

/* åªå¯¹åŠ è½½é¡µåšå‚ç›´å±…ä¸­ */
#screen-loading{
  align-items:center;        /* æ°´å¹³å±…ä¸­é‡Œé¢é‚£ä¸€åˆ— */
  justify-content:center;    /* å‚ç›´å±…ä¸­ */
}

/* é™åˆ¶åŠ è½½é¡µå†…å®¹æœ€å¤§å®½åº¦ï¼Œåˆ«å¤ªå®½ */
#screen-loading .loading-inner{
  width:100%;
  max-width:900px;
}

    h1,h2,h3{font-weight:700;}
    button{
      border:none;
      outline:none;
      border-radius:999px;
      padding:10px 22px;
      font-size:16px;
      cursor:pointer;
      margin:6px 4px;
      transition:.18s transform,.18s box-shadow;
    }
    button:hover{transform:translateY(-1px);box-shadow:0 0 10px rgba(248,250,252,.35);}
    .btn-primary{
      background:linear-gradient(135deg,#60a5fa,#a5b4fc);
      color:#fff;
    }
    .btn-secondary{
      background:linear-gradient(135deg,#f9a8d4,#fb7185);
      color:#fff;
    }
    .btn-ghost{
      background:rgba(15,23,42,.8);
      color:#e5e7eb;
      border:1px solid rgba(148,163,184,.7);
    }
    .badge{
      display:inline-block;
      padding:3px 10px;
      border-radius:999px;
      font-size:12px;
      background:rgba(15,23,42,.95);
      border:1px solid rgba(165,180,252,.8);
      margin-left:6px;
    }
    .logo-area{display:flex;align-items:center;gap:10px;margin-bottom:18px;}
    .fake-logo
{
  width:110px
;
  height:48px
;
  border-radius:12px
;
  background:#ffffff
;
  display
:flex;
  align-items
:center;
  justify-content
:center;
  box-shadow:0 4px 10px rgba(148,163,184,.35
);
}
    .fake-logo span{display:none;} /* ä¿é™©ï¼Œæ—§çš„ span ä¸ç”¨å°±éšè—æ‰ */
    .logo-img
{
  max-width:100%
;
  max-height:100%
;
  object-fit
:contain;
}
    .loading-bar{
      width:100%;
      height:18px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      overflow:hidden;
      margin-top:10px;
      box-shadow:0 0 0 1px rgba(148,163,184,.5) inset;
    }
    .loading-fill{
      height:100%;
      width:0%;
      background:repeating-linear-gradient(
        60deg,
        rgba(96,165,250,.25) 0,
        rgba(96,165,250,.25) 6px,
        rgba(129,140,248,.9) 6px,
        rgba(249,168,212,.9) 12px
      );
      transition:width .2s;
    }
    .loading-bubbles{margin-top:12px;height:46px;display:flex;align-items:flex-end;gap:6px;}
    .bubble{width:10px;border-radius:999px;background:rgba(96,165,250,.7);animation:bubble 1.3s infinite ease-in-out;}
    .bubble:nth-child(2){animation-delay:.15s;}
    .bubble:nth-child(3){animation-delay:.3s;}
    .bubble:nth-child(4){animation-delay:.45s;}
    .bubble:nth-child(5){animation-delay:.6s;}
    @keyframes bubble{
      0%{height:10px;opacity:.3;transform:translateY(0);}
      50%{height:26px;opacity:.95;transform:translateY(-6px);}
      100%{height:10px;opacity:.3;transform:translateY(0);}
    }
    .flex-row{display:flex;gap:18px;}
    .flex-col{display:flex;flex-direction:column;gap:10px;}
    .center{display:flex;justify-content:center;align-items:center;}
    .character-card{
      flex:1;
      background:rgba(15,23,42,.9);
      border-radius:18px;
      padding:14px;
      border:2px solid transparent;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      transition:.18s border,.18s transform,.18s box-shadow;
    }
    .character-card:hover{transform:translateY(-3px);box-shadow:0 0 18px rgba(129,140,248,.7);}
    .character-card.selected{border-color:#a5b4fc;box-shadow:0 0 18px rgba(129,140,248,.9);}
    /* é¢„è§ˆæ¡†ç¨å¾®å¤§ä¸€ç‚¹ï¼Œé€‚åˆå¡æ•´ä¸ªäººç‰© */
.avatar-preview{
  width:160px;
  height:180px;
  border-radius:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:10px;
  position:relative;
}

/* ç°åœ¨ç”¨çœŸå›¾äº†ï¼Œè¿™ä¸ªç™½è‰²ç›–å­å°±å…³æ‰ */
.avatar-preview::after{
  display:none;
}

/* è®©å›¾ç‰‡è‡ªé€‚åº”ç¼©æ”¾ */
.avatar-img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
  display:block;
}

    .speaks{
      font-size:13px;
      color:#e5e7eb;
      background:rgba(15,23,42,.95);
      border-radius:12px;
      padding:6px 9px;
      margin-top:4px;
      border:1px solid rgba(165,180,252,.9);
    }
    .input-inline{display:flex;align-items:center;gap:10px;margin-top:10px;}
    input[type="text"]{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(165,180,252,.8);
      background:rgba(15,23,42,.9);
      color:#e5e7eb;
      min-width:190px;
    }
    .hud{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:14px;
      padding:10px 14px;
      border-radius:14px;
      background:linear-gradient(90deg,rgba(15,23,42,.95),rgba(30,64,175,.9));
      border:1px solid rgba(129,140,248,.9);
    }
    .hud-left{display:flex;align-items:center;gap:10px;}
    .hud-avatar{
  width:50px;
  height:50px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at 10% 0,#93c5fd,#1d4ed8);
  position:relative;
  overflow:hidden;   /* ä¸ºäº†æŠŠå¤´åƒå›¾ç‰‡è£æˆåœ†å½¢ */
}

/* å¥³ç”ŸèƒŒæ™¯è¿˜æ˜¯ä¿ç•™ç²‰è‰²æ¸å˜ */
.hud-avatar.girl{
  background:radial-gradient(circle at 10% 0,#f9a8d4,#ec4899);
}

/* æ–°å¢ï¼šå¤´åƒå›¾ç‰‡è‡ªé€‚åº” */
.hud-avatar-img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

    .hud-avatar span{font-size:20px;}
    .hud-info{display:flex;flex-direction:column;font-size:13px;}
    .hud-info strong{font-size:16px;}
    .hud-right{font-size:13px;display:flex;gap:14px;align-items:center;}
    .map{
      flex:1;
      border-radius:18px;
      background:radial-gradient(circle at 20% 0,#93c5fd,#f9a8d4,#020617);
      padding:18px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
    }
    .map-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
    .tree-area{
      margin-top:8px;
      padding:10px;
      border-radius:14px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(165,180,252,.9);
      font-size:13px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .tree
{
  width:80px
;
  height:80px
;
  border-radius:999px
;
  position
:relative;
  overflow
:hidden;
  background:#fdf2ff
;
  box-shadow:0 0 20px rgba(252,165,255,.6
);
}

/* æ ‘å›¾ç‰‡é“ºæ»¡å®¹å™¨ */
.tree-img
{
  width:100%
;
  height:100%
;
  object-fit
:contain;
  display
:block;
}

/* ä¹‹å‰ç”»æ ‘å¹²çš„ä¼ªå…ƒç´ å…³æ‰ */
.tree::after
{
  display
:none;
}

/* æœªè§£é”çŠ¶æ€å˜ç° */
.tree.locked
{
  filter:grayscale(1
);
  opacity:.6
;
  box-shadow
:none;
}

/* è§£é”å¹¶ç»“æœæ—¶çš„é«˜äº® + â€œæœâ€ å­—å¾½ç« ï¼Œç»§ç»­ä¿ç•™ */
.tree.tree-fruit
{
  filter
:none;
  opacity:1
;
  box-shadow:0 0 24px rgba(252,165,255,.85
);
}
.tree.tree-fruit::before
{
  content:"æœ"
;
  position
:absolute;
  top:4px
;
  right:5px
;
  width:18px
;
  height:18px
;
  border-radius:50%
;
  background:#f97316
;
  color:#111
;
  font-size:11px
;
  display
:flex;
  align-items
:center;
  justify-content
:center;
}
    .map-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:12px;}
    .level-card
{
  position
:relative;
  border-radius:20px
;
  padding:14px 14px 16px
;
  background:#ffffff
;
  border:1px solid rgba(191,219,254,.9
);
  box-shadow:0 8px 18px rgba(148,163,184,.18
);
  transition:.2s transform,.2s box-shadow,.2s border-color,.2s
 background;
}

/* æ¯ä¸ªå…³å¡å•ç‹¬çš„æŸ”å’Œæ¸å˜èƒŒæ™¯ */
#btnLevel1{background:linear-gradient(135deg,#ffe7da,#fdf2ff
);}
#btnLevel2{background:linear-gradient(135deg,#e0f2fe,#f5f3ff
);}
#btnLevel3{background:linear-gradient(135deg,#f4f4ff,#ffeefb
);}
#btnLevel4{background:linear-gradient(135deg,#fff7ed,#fdf2ff
);}

.shield-tip{
  font-size:12px;
  margin-top:8px;
  color:#4b5563;
  background:#ffffff;
  border-radius:999px;
  border:1px solid #e5e7eb;
  padding:6px 12px;
}


    .level-card::before{
      content:"";
      position:absolute;
      inset:0;
      background:radial-gradient(circle at top,#38bdf81a,#fb71851a,transparent 60%);
      opacity:.8;
      pointer-events:none;
    }
    .level-card:hover{
      transform:translateY(-3px);
      box-shadow:0 0 14px rgba(129,140,248,.8);
    }
    .level-card.locked{
  position:relative;
  border-style:dashed;
  border-color:rgba(203,213,225,.9);
  box-shadow:none;
  opacity:0.7;
}
.level-card.locked::after{
  content:"ğŸ”’ æœªè§£é”";
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  color:#9ca3af;
  background:rgba(255,255,255,.6);
  backdrop-filter:blur(2px);
}
.level-card.locked .level-title,
.level-card.locked .level-sub{
  color:#cbd5f5;
}
.level-card.current{
  border-color:#a5b4fc;
  box-shadow:0 0 0 2px rgba(165,180,252,.5);
}
.level-card.current::before{
  content:"";
  position:absolute;
  left:14px;
  right:14px;
  bottom:10px;
  height:3px;
  border-radius:999px;
  background:linear-gradient(90deg,#60a5fa,#a855f7,#f97316);
  opacity:.85;
}
.level-card:hover:not(.locked){
  transform:translateY(-4px);
  box-shadow:0 10px 20px rgba(148,163,184,.35);
}

    .level-tag{
  position:absolute;
  top:10px;
  right:10px;
  padding:3px 10px;
  border-radius:999px;
  font-size:12px;
  background:rgba(15,23,42,.06);
  color:#4b5563;
}
/* æ ‡é¢˜å’Œå‰¯æ ‡é¢˜å­—ä½“å¾®è°ƒä¸€ä¸‹ï¼Œè®©å±‚çº§æ›´æ˜æ˜¾ */
.level-title{
  font-size:15px;
  font-weight:600;
  color:#111827;
  margin-bottom:6px;
}
.level-sub{
  font-size:12px;
  color:#9ca3af;
}

/* ç»™æ¯å…³é…ä¸€ä¸ªå°åœ†å›¾æ ‡ */
.level-icon{
  position:absolute;
  bottom:10px;
  right:12px;
  width:28px;
  height:28px;
  border-radius:999px;
  background:rgba(255,255,255,.9);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
}

    .bottom-nav{margin-top:12px;display:flex;justify-content:space-between;}
    .bottom-nav button{flex:1;}
    .bottom-nav button + button{margin-left:8px;}
    .dialog{
      position:absolute;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(15,23,42,.85);
      backdrop-filter:blur(6px);
      z-index:20;
    }
    .dialog.active{display:flex;}
    .dialog-box{
      background:rgba(15,23,42,1);
      padding:20px 22px;
      border-radius:18px;
      width:100%;
      max-width:420px;
      border:1px solid rgba(129,140,248,.9);
      box-shadow:0 0 20px rgba(15,23,42,.9);
    }
    .dialog-title{font-size:18px;margin-bottom:6px;}
    .dialog-content{
  font-size:14px;
  margin-bottom:14px;
  line-height:1.5;
  white-space: pre-line;   /* è¿™å¥æ˜¯æ–°åŠ çš„ */
}

    .game-area{
      margin-top:8px;
      border-radius:16px;
      background:rgba(15,23,42,.96);
      padding:10px;
      flex:1;
      display:flex;
      flex-direction:column;
    }
    .game-top-bar{display:flex;justify-content:space-between;align-items:center;font-size:13px;margin-bottom:6px;}
    .game-field{
      flex:1;
      border-radius:12px;
      border:1px solid rgba(51,65,85,.9);
      background:radial-gradient(circle at 20% 0,#1e293b,#020617);
      margin-top:6px;
      padding:8px;
      position:relative;
      overflow:hidden;
    }
    /* Level1 */
    .monster,.guardian{
      position:absolute;
      width:70px;
      height:70px;
      border-radius:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:28px;
      cursor:pointer;
      user-select:none;
    }
    .monster{
      background:radial-gradient(circle at 20% 0,#fb923c,#c2410c);
      box-shadow:0 0 15px rgba(248,250,252,.5);
    }
    .guardian{
      background:radial-gradient(circle at 20% 0,#4ade80,#16a34a);
      box-shadow:0 0 15px rgba(52,211,153,.7);
    }
    .monster span,.guardian span{font-size:28px;}
    .shield-tip{font-size:13px;margin-top:4px;color:#bfdbfe;}
    /* Level2 */
    .teeth-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-top:6px;}
    .tooth{
      height:50px;
      border-radius:14px;
      background:radial-gradient(circle at 20% 0,#facc15,#b45309);
      position:relative;
      cursor:pointer;
      border:1px solid rgba(248,250,252,.7);
    }
    .tooth.clean{background:radial-gradient(circle at 20% 0,#fdf2ff,#e5e7eb);}
    .tooth::after{
      content:"è›€";
      position:absolute;
      top:4px;
      left:50%;
      transform:translateX(-50%);
      font-size:12px;
      color:#111;
    }
    .tooth.clean::after{content:"âœ¨";font-size:14px;top:8px;}
    /* Level3 */
    .puzzle-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-top:8px;width:210px;}
    .puzzle-tile{
      width:66px;
      height:66px;
      border-radius:12px;
      background:linear-gradient(135deg,#60a5fa,#c4b5fd);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
      font-weight:bold;
      cursor:pointer;
      user-select:none;
      border:1px solid rgba(248,250,252,.7);
    }
    .puzzle-tile.empty{
      background:rgba(15,23,42,.8);
      border-style:dashed;
      cursor:default;
    }
    .puzzle-hint{font-size:13px;margin-top:6px;color:#bfdbfe;}
    /* Level4 */
    .poster-layout{display:flex;gap:10px;margin-top:6px;flex:1;}
    .poster-left{
      flex:2;
      border-radius:14px;
      background:#020617;
      border:1px solid rgba(129,140,248,.8);
      padding:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
    }
    .poster-left img{max-width:100%;max-height:100%;object-fit:contain;border-radius:12px;}
    .poster-right{
      flex:1;
      border-radius:14px;
      background:rgba(15,23,42,.96);
      border:1px solid rgba(129,140,248,.8);
      padding:8px;
      font-size:13px;
    }
    .sticker-btn{display:block;width:100%;margin-bottom:6px;font-size:13px;}
    .sticker{
      position:absolute;
      width:80px;
      height:80px;
      border-radius:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:14px;
      font-weight:bold;
      color:#fff;
      cursor:grab;
      user-select:none;
    }
    .sticker.boy{background:radial-gradient(circle at 20% 0,#93c5fd,#1d4ed8);}
    .sticker.girl{background:radial-gradient(circle at 20% 0,#f9a8d4,#ec4899);}
    .sticker.heart{background:radial-gradient(circle at 20% 0,#f97316,#ea580c);}
    /* overlay result */
    #resultOverlay{
      position:absolute;
      inset:0;
      background:rgba(15,23,42,.88);
      backdrop-filter:blur(6px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:30;
    }
    #resultOverlay.active{display:flex;}
    #resultBox{
      background:#020617;
      border-radius:20px;
      padding:20px 22px;
      border:1px solid rgba(129,140,248,.9);
      max-width:460px;
      width:100%;
      box-shadow:0 0 20px rgba(15,23,42,.9);
    }
    #resultBox h3{margin-bottom:6px;}
    #resultBox p{font-size:14px;margin-bottom:10px;line-height:1.6;}
    .medal{
      display:inline-block;
      margin-top:4px;
      padding:3px 10px;
      border-radius:999px;
      font-size:12px;
      background:linear-gradient(135deg,#fde68a,#fb923c);
      color:#111;
      font-weight:bold;
    }
   /* æ‰‹æœºç«¯é€‚é…ï¼šå…è®¸çºµå‘æ»šåŠ¨ï¼Œå†…å®¹ä¸è¦è¢«æŒ¤æ²¡ */
@media (max-width:900px){
  /* æ•´ä¸ªé¡µé¢ä»â€œå±…ä¸­å¡ç‰‡â€æ”¹æˆæ­£å¸¸ä»ä¸Šå¾€ä¸‹æ’ç‰ˆ */
  body{
    display:block;
    height:auto;
    min-height:100vh;
    background:linear-gradient(135deg,#fdf2ff,#e0f2fe);
  }

  /* å¤–å±‚å®¹å™¨é«˜åº¦ä¸å†æ­»é” 100vhï¼Œæ”¹æˆè‡ªé€‚åº”ï¼Œå¯æ»šåŠ¨ */
  #game{
    width:100%;
    height:auto;
    min-height:100vh;
    border-radius:0;
    box-shadow:none;
  }

  /* æ¯ä¸ª screen ä¹Ÿä¸é”æ­»é«˜åº¦ï¼Œå…è®¸å†…éƒ¨æ»šåŠ¨ */
  .screen{
    height:auto;
    min-height:100vh;
    padding:16px 14px 28px;
    overflow-y:auto;
  }

  /* åœ°å›¾ã€åˆ›å»ºè§’è‰²é‡Œçš„å·¦å³å¸ƒå±€æ”¹æˆä¸Šä¸‹å †å  */
  .flex-row{
    flex-direction:column;
  }

   
/* åˆ›å»ºè§’è‰²é¡µï¼šå¡ç‰‡ç˜¦èº«ç‰ˆ */
  .character-card
{
    padding:10px 12px
;
    border-radius:16px
;
    /* ç«–æ’çš„æ—¶å€™ä¸Šä¸‹åˆ«å¤ªæŒ¤ */
    gap:8px
;
  }

  /* äººç‰©å›¾å†ç¼©ä¸€ç‚¹ï¼Œæ•´ä½“é«˜åº¦ä¼šä¸‹å»å¾ˆå¤š */
  .avatar-preview
{
    width:120px
;
    height:140px
;
    margin:0 auto 6px
;
  }

  /* æ–‡æ¡ˆä¹Ÿç¨å¾®ç¼©ä¸€ä¸‹å­—å·ï¼Œé¿å…æ’‘é«˜ */
  .character-card div[style*="font-weight:600"
]{
    font-size:13px
;
  }
  .speaks
{
    font-size:12px
;
    padding:5px 8px
;
  }

  /* æ•´ä¸ªåˆ›å»ºé¡µåº•éƒ¨å¤šç•™ä¸€ç‚¹ç©ºï¼ŒæŒ‰é’®ä¸ä¼šè¢«è´´è¾¹é®ä½ */
  #screen-character
{
    padding-bottom:40px
;
  }
}


  /* æ¸¸æˆåŒºåŸŸå’Œæ¸¸æˆåœºåœ°å°½é‡æ’‘æ»¡å‰©ä½™é«˜åº¦ */
  .game-area{
    flex:1;
    margin-top:10px;
  }
  .game-top-bar{
    flex-wrap:wrap;
    gap:6px;
  }
  .game-field{
    flex:1;
    min-height:260px;   /* é˜²æ­¢å˜æˆå°å°ä¸€å— */
  }
 
/* åœ°å›¾å¡ç‰‡åœ¨æ‰‹æœºç«¯æ’ä¸¤åˆ—ï¼Œåˆ«å¤ªæŒ¤ */
  .map-grid
{
    grid-template-columns:repeat(2,1
fr);
    gap:10px
;
  }

  /* ç»™æ ‡é¢˜é¢„ç•™å‡ºå³ä¾§ç©ºé—´ï¼Œè®©â€œå…³å¡1â€ä¸ä¼šå‹ä¸Šæ¥ */
  .level-title
{
    font-size:14px
;
    margin-right:48px
;
  }
  .level-sub
{
    font-size:11px
;
  }
  .level-tag
{
    top:8px
;
    right:8px
;
    font-size:11px
;
    padding:2px 8px
;
  }

    /* === æµ…è‰²ç²‰è“ä¸»é¢˜è¦†ç›–ï¼Œä»è¿™é‡Œå¼€å§‹ç²˜åˆ° <style> æœ€å === */

body{
  background:linear-gradient(135deg,#fdf2ff,#e0f2fe);
  color:#111;
}

/* æ¸¸æˆå¤–å£³å˜æˆç™½è‰²å¡ç‰‡ */
#game{
  background:#ffffff;
  box-shadow:0 14px 40px rgba(15,23,42,.18);
}

/* æ¯ä¸ª screen èƒŒæ™¯æ”¹æˆæµ…ç²‰è“ï¼Œè€Œä¸æ˜¯çº¯æ·±è‰² */
.screen{
  background:radial-gradient(circle at top,#f9fbff,#eef2ff);
}

/* æŒ‰é’®å¹½çµæ¬¾æµ…ä¸€ç‚¹ */
.btn-ghost{
  background:#eff6ff;
  color:#1f2937;
  border:1px solid #bfdbfe;
}

/* é¡¶éƒ¨å°å¾½ç« å˜æµ…è‰² */
.badge{
  background:#eff6ff;
  color:#4b5563;
  border:1px solid #c7d2fe;
}

/* è§’è‰²å¡ç‰‡ï¼šé»˜è®¤æµ…è“ï¼Œå¥³ç”Ÿé‚£å¼ æ”¹æˆæµ…ç²‰ */
.character-card{
  background:#f9fafb;
}
#cardBoy{
  background:linear-gradient(135deg,#e0f2fe,#dbeafe);
}
#cardGirl{
  background:linear-gradient(135deg,#ffe4f5,#fecaca);
}

/* è§’è‰²èº«ä½“å’Œå¯¹è¯æ°”æ³¡å˜æˆæµ…è‰²å— */
.avatar-body{
  background:rgba(15,23,42,.04);
  border-color:#e5e7eb;
}
.speaks{
  background:#ffffff;
  border-color:#e5e7eb;
  color:#4b5563;
}

/* è¾“å…¥æ¡†ç™½åº• */
input[type="text"]{
  background:#ffffff;
  color:#111827;
  border-color:#cbd5f5;
}

/* é¡¶éƒ¨ HUD æ¡æ·¡ç²‰è“æ¸å˜ */
.hud{
  background:linear-gradient(90deg,#eff6ff,#fdf2ff);
  border-color:#c7d2fe;
}
.hud-info span{
  color:#4b5563;
}

/* åœ°å›¾åŒºåŸŸ & å®ˆæŠ¤æ ‘åŒºåŸŸæµ…è‰² */
.map{
  background:linear-gradient(180deg,#f9fbff,#eef2ff);
}
.tree-area{
  background:#ffffff;
  border-color:#e5e7eb;
}

/* å…³å¡å¡ç‰‡ç™½è‰²ï¼Œä¿æŒç²‰è“æè¾¹ */
.level-card{
  background:#ffffff;
}

/* æ¸¸æˆå†…å®¹åŒºåŸŸæ”¹æˆæµ…è‰² */
.game-area{
  background:#f9fafb;
}
.game-field{
  background:#ffffff;
}

/* æµ·æŠ¥åŒºåŸŸæµ…è‰² */
.poster-left{
  background:#f9fafb;
}
.poster-right{
  background:#ffffff;
}

/* å¼¹çª—å’Œç»“æœæµ®å±‚å˜æˆâ€œç™½è‰²å¡ç‰‡ + åŠé€æ˜ç°èƒŒæ™¯â€ */
.dialog{
  background:rgba(148,163,184,.25);
}
.dialog-box{
  background:#ffffff;
  color:#111827;
}
#resultOverlay{
  background:rgba(148,163,184,.30);
}
#resultBox{
  background:#ffffff;
  color:#111827;
}

  </style>

</head>
<body>
<div id="game">
  <!-- åŠ è½½ç•Œé¢ -->
  <div id="screen-loading" class="screen active">
   <div class="loading-inner"> 
    <div class="logo-area">
      <div class="fake-logo">
  <img src="images/yayale-logo.png" alt="ä¼¢ç‰™ä¹" class="logo-img">
</div>
      <div>
        <h1>é˜²è›€å†’é™©å²›</h1>
        <div style="font-size:13px;margin-top:4px;">920çˆ±ç‰™æ—¥åˆ°å•¦ï¼Œå’Œä¼¢ç‰™éª‘å£«ä¸€èµ·æ‰“è´¥è›€ç‰™æ€ªå…½å§ï½</div>
      </div>
    </div>
    <div style="margin-top:18px;font-size:14px;">æ­£åœ¨ç”¨é˜²è›€æ³¡æ²«å¡«å……åŠ è½½è¿›åº¦ï¼Œè¯·ç¨ç­‰â€¦</div>
    <div class="loading-bar">
      <div class="loading-fill" id="loadingFill"></div>
    </div>
    <div class="loading-bubbles">
      <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
    </div>
    <div style="margin-top:20px;display:flex;gap:12px;">

  </div>
    </div>
    </div>

  <!-- è§’è‰²åˆ›å»º -->
  <div id="screen-character" class="screen">
    <h2>åˆ›å»ºä½ çš„ä¼¢ç‰™ä¹é˜²è›€éª‘å£«</h2>
    <div style="font-size:13px;margin-top:4px;">é€‰æ‹©å–œæ¬¢çš„éª‘å£«å½¢è±¡ï¼Œç»™è‡ªå·±å–ä¸€ä¸ªé˜²è›€æ˜µç§°ï¼Œä¸€èµ·å‡ºå‘å®ˆæŠ¤ç‰™é½¿åŸå ¡ã€‚</div>
    <div class="flex-row" style="margin-top:14px;">
      <div id="cardBoy" class="character-card selected">
  <div class="avatar-preview avatar-boy">
    <img src="images/knight-boy.png" alt="è“ç™½ä¼¢ç‰™éª‘å£«" class="avatar-img">
  </div>
  <div style="font-size:14px;font-weight:600;color:#1f2937;margin-top:4px;">ç‰™å°è“ä¼¢ç‰™éª‘å£«</div>
  <div class="speaks">â€œäº¤ç»™æˆ‘ï¼Œç³–é…¸æ€ªå…½ä¸€ä¸ªä¹Ÿåˆ«æƒ³è·‘ï¼â€</div>
</div>

      <div id="cardGirl" class="character-card">
  <div class="avatar-preview avatar-girl">
    <img src="images/knight-girl.png" alt="ç²‰ç´«ä¼¢ç‰™éª‘å£«" class="avatar-img">
  </div>
  <div style="font-size:14px;font-weight:600;color:#1f2937;margin-top:4px;">é½¿å°ç²‰ä¼¢ç‰™éª‘å£«</div>
  <div class="speaks">â€œåˆ·å¾—å¹²å¹²å‡€å‡€ï¼Œæˆ‘ä»¬ä¸€èµ·è®©ç¬‘å®¹å‘å…‰ã€‚â€</div>
</div>

    </div>
    <div class="input-inline">
      <label for="nickname" style="font-size:14px;">éª‘å£«æ˜µç§°ï¼š</label>
      <input id="nickname" type="text" />
      <button id="btnRandomName" class="btn-ghost">éšæœºç”Ÿæˆ</button>
    </div>
    <div style="margin-top:10px;font-size:13px;">æç¤ºï¼šæ˜µç§°é»˜è®¤ä¼šæ˜¯â€œé˜²è›€éª‘å£«+æ•°å­—â€ï¼Œä½ ä¹Ÿå¯ä»¥æ”¹æˆè‡ªå·±å–œæ¬¢çš„åå­—ã€‚</div>
    <div style="margin-top:18px;">
      <button id="btnEnterIsland" class="btn-primary">è¿›å…¥é˜²è›€å†’é™©å²›</button>
    </div>
  </div>

  <!-- é¦–é¡µåœ°å›¾ -->
  <div id="screen-home" class="screen">
    <div class="hud">
      <div class="hud-left">
         
<div id="hudAvatar" class="hud-avatar"
>
      <img class="hud-avatar-img" src="images/tooth-boy.png" alt="ä¼¢ç‰™éª‘å£«å¤´åƒ"
>
    </div
>
        <div class="hud-info">
          <strong id="hudName">é˜²è›€éª‘å£«</strong>
          <span>å½“å‰ä¼¢åˆ†ï¼š<span id="hudPoints">0</span></span>
        </div>
      </div>
      <div class="hud-right">
        
       <button id="btnBackToCreator" class="btn-ghost">è¿”å›</button> 
       <button id="btnReset" class="btn-ghost">é‡ç½®</button
>
      </div>
    </div>
    <div class="flex-row" style="margin-top:6px;height:calc(100% - 80px);">
      <div class="map">
        <div class="map-top">
          <div>
            <h3>å£è…”æ£®æ— Â· å†’é™©åœ°å›¾</h3>
            <div style="font-size:13px;margin-top:2px;">ç‚¹å‡»å…³å¡å›¾æ ‡å¼€å§‹æŒ‘æˆ˜ï¼Œè¾¾æˆç›®æ ‡å³å¯è§£é”ä¸‹ä¸€åº§å²›ã€‚</div>
          </div>
          <div class="badge">ç‰™é½¿åŸå ¡æ­£ç­‰å¾…å®ˆæŠ¤</div>
        </div>
       <div class="tree-area">
  <div id="guardTree" class="tree locked">
    <img id="guardTreeImg" class="tree-img" src="images/guard-tree.png" alt="é˜²è›€å®ˆæŠ¤æ ‘">
  </div>
  <div>
    <div style="font-size:14px;">é˜²è›€å®ˆæŠ¤æ ‘</div>
    <div id="treeText" style="font-size:13px;margin-top:2px;">
      å®Œæˆå››å¤§å…³å¡åï¼Œè¿™æ£µæ ‘ä¼šå¼€èŠ±ç»“æœï¼Œé•¿å‡ºå…‘æ¢æœå®ã€‚
    </div>
  </div>
</div>

        <div class="map-grid">
  <div id="btnLevel1" class="level-card">
    <div class="level-tag">å…³å¡1</div>
    <div class="level-title">ç³–é…¸æ€ªå…½é€€æ•£</div>
    <div class="level-sub">60ç§’å†…å‡»é€€ä¸å°‘äº30åªç³–é…¸æ€ªå…½ï¼Œæ³¨æ„åˆ«è¯¯ä¼¤é˜²è›€å«å£«ã€‚</div>
    <div class="level-icon">ğŸ­</div>
  </div>

  <div id="btnLevel2" class="level-card locked">
    <div class="level-tag">å…³å¡2</div>
    <div class="level-title">é—ªå…‰ç‰™åˆ·éª‘å£«</div>
    <div class="level-sub">è·Ÿç€ä¼¢ç‰™éª‘å£«ä¸€èµ·åˆ·ç‰™ï¼Œåˆ·æ‰æ‰€æœ‰è›€æ–‘ã€‚</div>
    <div class="level-icon">ğŸª¥</div>
  </div>

  <div id="btnLevel3" class="level-card locked">
    <div class="level-tag">å…³å¡3</div>
    <div class="level-title">æ‹¼å›¾å¯»å®è®°</div>
    <div class="level-sub">æ‹¼å‡ºä¼¢ç‰™ä¹IPå›¾æ¡ˆï¼Œå‘ç°é˜²è›€å®è—ã€‚</div>
    <div class="level-icon">ğŸ§©</div>
  </div>

  <div id="btnLevel4" class="level-card locked">
    <div class="level-tag">å…³å¡4</div>
    <div class="level-title">ç¬‘å®¹åˆ›æ„å·¥åŠ</div>
    <div class="level-sub">ä¸Šä¼ äº²å­ç¬‘è„¸ï¼Œæ‰“é€ ä¸“å±é˜²è›€æµ·æŠ¥ã€‚</div>
    <div class="level-icon">ğŸ˜Š</div>
  </div>
</div>

        <div class="bottom-nav">
          <button class="btn-ghost" id="btnSignin">æ¯æ—¥ç­¾åˆ°</button>
          <button class="btn-ghost" id="btnProfile">ä¸ªäººä¸­å¿ƒ</button>
          <button class="btn-ghost" id="btnShop">å…‘æ¢å•†åŸ</button>
        </div>
      </div>
    </div>
  </div>

 <!-- å…³å¡1ï¼šæ¸¸æˆé¡µé¢ -->
<div id="screen-level1" class="screen">
  <div class="hud">
    <div class="hud-left">
      <div id="hudAvatar1" class="hud-avatar">
        <img class="hud-avatar-img" src="images/tooth-boy.png" alt="ä¼¢ç‰™éª‘å£«å¤´åƒ">
      </div>
      <div class="hud-info">
        <strong>ç³–é…¸æ€ªå…½é€€æ•£</strong>
        <span>60ç§’å‡»é€€ä¸å°‘äº30åªç³–é…¸æ€ªå…½ã€‚</span>
      </div>
    </div>
    <div class="hud-right">
      
      <button class="btn-ghost" onclick="backToHome()">è¿”å›</button>
    </div>
  </div>

  <div class="game-area">
    <div class="game-top-bar">
      <span>å€’è®¡æ—¶ï¼š<strong id="timerL1">60</strong> ç§’</span>
      <span>æœ¬å…³å‡»é€€æ€ªå…½ï¼š<strong id="hitCountL1">0</strong></span>
      <button id="btnStartL1" class="btn-primary">å¼€å§‹æŒ‘æˆ˜</button>
    </div>
    <div class="game-field" id="fieldL1">
      <div style="position:absolute;bottom:6px;left:6px;font-size:12px;max-width:220px;opacity:.85;">
        ä¼¢ç‰™éª‘å£«ä¸¾èµ·é˜²è›€ç›¾ç‰Œï¼šâ€œè¯¯ç‚¹åˆ°é˜²è›€å«å£«æ—¶ï¼Œæˆ‘ä¼šå¸®ä½ æŒ¡ä¸€ä¸‹ï¼Œä½†æ˜¯ä¼šæ‰£5åˆ†å“¦ã€‚â€
      </div>
    </div>
    <div class="shield-tip">ç‚¹å‡»æ©™è‰²â€œç³–é…¸æ€ªå…½â€å¾—åˆ†ï¼Œç»¿è‰²â€œé˜²è›€å«å£«â€ä¸è¦ç‚¹ã€‚</div>
  </div>
</div>


  <!-- å…³å¡2ï¼šæ¸¸æˆé¡µé¢ -->
<div id="screen-level2" class="screen">
  <div class="hud">
    <div class="hud-left">
      <div id="hudAvatar2" class="hud-avatar">
        <img class="hud-avatar-img" src="images/tooth-boy.png" alt="ä¼¢ç‰™éª‘å£«å¤´åƒ">
      </div>
      <div class="hud-info">
        <strong>é—ªå…‰ç‰™åˆ·</strong>
        <span>è·Ÿç€éª‘å£«å­¦å·´æ°åˆ·ç‰™æ³•ï¼Œåˆ·å¹²å‡€ç‰™é½¿ã€‚</span>
      </div>
    </div>
    <div class="hud-right">
      
      <button class="btn-ghost" onclick="backToHome()">è¿”å›</button>
    </div>
  </div>

  <div class="game-area">
    <div class="game-top-bar">
      <span>å€’è®¡æ—¶ï¼š<strong id="timerL2">60</strong> ç§’</span>
      <span>æ¸…æ´åº¦è¯„åˆ†ï¼š<strong id="scoreL2">0</strong> åˆ†</span>
      <button id="btnStartL2" class="btn-primary">å¼€å§‹åˆ·ç‰™æ¯”èµ›</button>
    </div>
    <div style="font-size:13px;margin-top:4px;">
      æç¤ºï¼šç‚¹å‡»æ¯é¢—ç‰™é½¿å¤šæ¬¡ï¼Œç›´åˆ°å˜æˆæ´ç™½çŠ¶æ€ï¼Œå…¨éƒ¨å˜ç™½å³å¯æ‹¿åˆ°é«˜åˆ†ã€‚
    </div>
    <div class="game-field">
      <div style="font-size:13px;">
        ä¼¢ç‰™éª‘å£«æ¼”ç¤ºï¼šâ€œåˆ·ç‰™æ—¶ç‰™åˆ·ä¸ç‰™é¢æˆ45Â°ï¼Œå°å¹…åº¦éœ‡é¢¤ï¼Œå†ç”±ç‰™é¾ˆå‘ç‰™å°–è½»è½»åˆ·ã€‚â€
      </div>
      <div id="teethGrid" class="teeth-grid"></div>
    </div>
  </div>
</div>


  <!-- å…³å¡3 -->
  <div id="screen-level3" class="screen">
    <div class="hud">
      <div class="hud-left">
<div id="hudAvatar3" class="hud-avatar"
>
    <img class="hud-avatar-img" src="images/tooth-boy.png" alt="ä¼¢ç‰™éª‘å£«å¤´åƒ"
>
  </div
>        
        <div class="hud-info">
          <strong>æ‹¼å›¾å¯»å®è®°</strong>
          <span>æ‹¼å‡ºæ•°å­—æ‹¼å›¾ï¼Œæ‰¾å‡ºéšè—å®è—ã€‚</span>
        </div>
      </div>
      <div class="hud-right">
        
        <button class="btn-ghost" onclick="backToHome()">è¿”å›</button>
      </div>
    </div>
    <div class="game-area">
      <div class="game-top-bar">
        <span>ç”¨æ—¶ï¼š<strong id="timeL3">0</strong> ç§’</span>
        <span>æ­¥æ•°ï¼š<strong id="stepsL3">0</strong></span>
        <button id="btnStartL3" class="btn-primary">å¼€å§‹æ‹¼å›¾</button>
      </div>
      <div class="game-field center">
        <div>
          <div style="font-size:13px;margin-bottom:4px;">
  æç¤ºï¼šç‚¹å‡»æ•°å­—æ–¹å—ï¼Œå°†å…¶ä¸æ—è¾¹çš„ç©ºæ ¼äº¤æ¢ä½ç½®ï¼Œæ’æˆ 1~3 å³å¯å®Œæˆæ‹¼å›¾ã€‚
</div>

          <div id="puzzleGrid" class="puzzle-grid"></div>
          <div class="puzzle-hint">éšè—å›¾æ¡ˆè±¡å¾è“ç™½ä¸ç²‰ç´«ä¼¢ç‰™éª‘å£«åŒæ¡†ï¼Œæ—è¾¹è¿˜æœ‰ä¼¢ç‰™ä¹äº§å“å®è—ã€‚</div>
        </div>
      </div>
    </div>
  </div>

  <!-- å…³å¡4 -->
  <div id="screen-level4" class="screen">
    <div class="hud">
      <div class="hud-left">
        <div id="hudAvatar4" class="hud-avatar"
>
    <img class="hud-avatar-img" src="images/tooth-boy.png" alt="ä¼¢ç‰™éª‘å£«å¤´åƒ"
>
  </div
>
        <div class="hud-info">
          <strong>ç¬‘å®¹åˆ›æ„å·¥åŠ</strong>
          <span>ä¸Šä¼ äº²å­ç¬‘è„¸ï¼Œæ‹–åŠ¨è´´çº¸è£…é¥°é˜²è›€æµ·æŠ¥ã€‚</span>
        </div>
      </div>
      <div class="hud-right">
        
        <button class="btn-ghost" onclick="backToHome()">è¿”å›</button>
      </div>
    </div>
    <div class="game-area">
      <div class="game-top-bar">
        <div>
          <label style="font-size:13px;">é€‰æ‹©ç…§ç‰‡ï¼š</label>
          <input id="photoInput" type="file" accept="image/*" style="font-size:12px;max-width:230px;">
        </div>
        <button id="btnFinishPoster" class="btn-primary">ç”Ÿæˆé˜²è›€ç¬‘å®¹æµ·æŠ¥</button>
      </div>
      <div class="poster-layout">
        <div id="posterArea" class="poster-left">
          <span id="posterPlaceholder" style="font-size:13px;color:#9ca3af;">ä¸Šä¼ ä¸€å¼ éœ²é½¿ç¬‘ç…§ç‰‡ï¼Œæˆ–å…ˆç”¨ç¤ºæ„å›¾æµ‹è¯•æ•ˆæœã€‚</span>
        </div>
        <div class="poster-right">
          <div style="font-size:13px;margin-bottom:6px;">å¯ç”¨è´´çº¸</div>
          <button class="btn-secondary sticker-btn" id="btnStickerBoy">æ·»åŠ è“ç™½ä¼¢ç‰™éª‘å£«è´´çº¸</button>
          <button class="btn-secondary sticker-btn" id="btnStickerGirl">æ·»åŠ ç²‰ç´«ä¼¢ç‰™éª‘å£«è´´çº¸</button>
          <button class="btn-secondary sticker-btn" id="btnStickerHeart">æ·»åŠ â€œé˜²è›€ç¬‘å®¹â€è´´çº¸</button>
          <div style="font-size:12px;margin-top:4px;line-height:1.5;">
            æç¤ºï¼šç‚¹å‡»è´´çº¸åå¯ä»¥æ‹–åŠ¨ä½ç½®ï¼Œæ”¾åˆ°ç…§ç‰‡æ—è¾¹æˆ–è§’è½ï¼Œè®©ä¼¢ç‰™éª‘å£«ç»™ç¬‘å®¹â€œç‚¹èµâ€ã€‚</div>
        </div>
      </div>
    </div>
  </div>

  <!-- é€šç”¨å¼¹çª—ï¼šç­¾åˆ°/ä¸ªäººä¸­å¿ƒ/å•†åŸ -->
  <div id="genericDialog" class="dialog">
    <div class="dialog-box">
      <div class="dialog-title" id="genericTitle">æç¤º</div>
      <div class="dialog-content" id="genericContent"></div>
      <div style="text-align:right;">
        <button class="btn-primary" id="btnDialogOk">çŸ¥é“å•¦</button>
      </div>
    </div>
  </div>

  <!-- ç»“æœæµ®å±‚ -->
  <div id="resultOverlay">
    <div id="resultBox">
      <h3 id="resultTitle">æŒ‘æˆ˜ç»“æœ</h3>
      <p id="resultText"></p>
      <div id="resultExtra"></div>
      <div style="margin-top:10px;text-align:right;">
        <button class="btn-primary" id="btnResultBack">è¿”å›åœ°å›¾</button>
      </div>
    </div>
  </div>
</div>

<script>
   // å…¨å±€çŠ¶æ€
  let player = { character: "boy", name: ""
 };
  let yaPoints = 0
;
  let hasSignedToday = false
;
  let unlocked = {1:true,2:false,3:false,4:false
};
  let loadingProgress = 0
;
  let
 loadingInterval;

  // æœ¬åœ°å­˜æ¡£ key å’Œä¼¢åˆ†æ˜ç»†æ—¥å¿—
  const STORAGE_KEY = "ya_island_state_v1"
;
  const LOG_KEY = "ya_island_log_v1"
;
  let
 pointLog = [];
  // å…³å¡å®šæ—¶å™¨å’ŒçŠ¶æ€
  let timerL1=null,timeL1=60,scoreL1=0,hitCountL1=0;
  let timerL2=null,timeL2=60,cleanCount=0,totalTeeth=18;
  let timerL3=null,timeL3=0,stepsL3=0,puzzleState=[];
  let draggingSticker=null,dragOffsetX=0,dragOffsetY=0;
  // å…¬å…±å‡½æ•°
  function showScreen(id){
    document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    updateHUD();
  }
   
     function resetGameState() {
    if (!confirm("ç¡®å®šè¦æ¸…ç©ºæœ¬åœ°è®°å½•å¹¶é‡æ–°å¼€å§‹å—ï¼Ÿæ­¤æ“ä½œåªå½±å“å½“å‰è®¾å¤‡ã€‚")) return;
    localStorage.removeItem(STORAGE_KEY);
    localStorage.removeItem(LOG_KEY);
    localStorage.removeItem("ya_island_signed_date");
    player = { character: "boy", name: "" };
    yaPoints = 0;
    hasSignedToday = false;
    unlocked = {1:true,2:false,3:false,4:false};
    pointLog = [];
    updateHUD();
    showScreen("screen-character");
  }

// ç”Ÿæˆâ€œä»Šå¤©â€çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦ç­¾åˆ°
  function getTodayKey(
) {
    const d = new Date
();
    const y = d.getFullYear
();
    const m = String(d.getMonth() + 1).padStart(2, "0"
);
    const day = String(d.getDate()).padStart(2, "0"
);
    return `${y}-${m}-${day}
`;
  }

  // ä¿å­˜å½“å‰æ¸¸æˆè¿›åº¦åˆ° localStorage
  function saveGameState(
) {
    const
 state = {
      player,
      yaPoints,
      unlocked,
      signedDate: localStorage.getItem("ya_island_signed_date") || null
    };
    try
 {
      localStorage.setItem(STORAGE_KEY, JSON.stringify
(state));
    } 
catch
 (e) {
      console.warn("saveGameState error"
, e);
    }
  }

  // è¯»å–æœ¬åœ°å­˜æ¡£ï¼Œæ¢å¤è¿›åº¦
  function loadGameState(
) {
    const raw = localStorage.getItem(STORAGE_KEY
);
    if (!raw) return
;
    try
 {
      const state = JSON.parse
(raw);
      if (state.player) player = state.player
;
      if (typeof state.yaPoints === "number") yaPoints = state.yaPoints
;
      if (state.unlocked) unlocked = state.unlocked
;
      if (state.signedDate
) {
        localStorage.setItem("ya_island_signed_date", state.signedDate
);
        hasSignedToday = state.
signedDate === getTodayKey
();
      }
    } 
catch
 (e) {
      console.warn("loadGameState error"
, e);
    }
  }

  // ä¼¢åˆ†æ˜ç»†æ—¥å¿—åŠ è½½
  function loadLog(
) {
    const raw = localStorage.getItem(LOG_KEY
);
    if
 (!raw) {
      pointLog = [];
      return
;
    }
    try
 {
      pointLog = 
JSON.parse
(raw) || [];
    } 
catch
 {
      pointLog = [];
    }
  }

  // å¾€ä¼¢åˆ†æ˜ç»†é‡Œè®°ä¸€æ¡
  function pushLog(reason, delta
) {
    const
 item = {
      time: new Date().toLocaleString
(),
      reason,
      delta
    };
    pointLog.
unshift
(item);
    pointLog = pointLog.
slice(0, 20); // åªç•™æœ€è¿‘ 20 æ¡
    try
 {
      localStorage.setItem(LOG_KEY, JSON.stringify
(pointLog));
    } 
catch
 (e) {
      console.warn("pushLog error"
, e);
    }
  }

  // é¡µé¢åˆ‡æ¢
  function showScreen(id
){
    document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"
));
    document.getElementById(id).classList.add("active"
);
    updateHUD
();
  }

  function updateHUD(
){
    const name = player.name || "é˜²è›€éª‘å£«"
;
    document.getElementById("hudName").textContent
 = name;
    document.getElementById("hudPoints").textContent
 = yaPoints;

    [
"pointsL1","pointsL2","pointsL3","pointsL4"].forEach(id=>{
      const el = document.getElementById
(id);
      if(el) el.textContent
 = yaPoints;
    });


  // æ ¹æ®è§’è‰²é€‰æ‹©åˆ‡æ¢å¤´åƒå›¾ç‰‡
    const avatarSrc = (player.character === "girl"
)
      ? 
"images/tooth-girl.png"
      : 
"images/tooth-boy.png"
;

    document.querySelectorAll(".hud-avatar-img").forEach(img=>{
      img.
src
 = avatarSrc;
    });

    const avatarHome = document.getElementById("hudAvatar"
);
    avatarHome.
classList.toggle("girl", player.character === "girl"
);
    [
"hudAvatar1","hudAvatar2","hudAvatar3","hudAvatar4"].forEach(id=>{
      const el = document.getElementById
(id);
      if(el) el.classList.toggle("girl", player.character === "girl"
);
    });


    // å®ˆæŠ¤æ ‘çŠ¶æ€
    const tree=document.getElementById("guardTree");
    const treeText=document.getElementById("treeText");
    if(unlocked[4] && unlocked[1] && unlocked[2] && unlocked[3]){
      tree.classList.remove("locked");
      tree.classList.add("tree-fruit");
      treeText.textContent="æ­å–œå®Œæˆå››å¤§å…³å¡ï¼Œé˜²è›€å®ˆæŠ¤æ ‘å·²ç»ç»“å‡ºâ€œå…‘æ¢æœå®â€ï¼Œå¯ä»¥å‰å¾€å…‘æ¢å•†åŸé¢†å–éª‘å£«å‘¨è¾¹ã€‚";
    }
  }
  function lockLevelCard(level){
    const card=document.getElementById("btnLevel"+level);
    if(!card) return;
    if(unlocked[level]) card.classList.remove("locked");
    else card.classList.add("locked");
  }
  function backToHome(){
    showScreen("screen-home");
  }
  function randomNickname(){
    const num=Math.floor(Math.random()*900+100);
    return "é˜²è›€éª‘å£«"+num;
  }
  function openGenericDialog(title,text){
    document.getElementById("genericTitle").textContent=title;
    document.getElementById("genericContent").textContent=text;
    document.getElementById("genericDialog").classList.add("active");
  }
  function closeGenericDialog(){
    document.getElementById("genericDialog").classList.remove("active");
  }
  function showResult(title,html){
    document.getElementById("resultTitle").textContent=title;
    document.getElementById("resultText").innerHTML=html;
    const extra=document.getElementById("resultExtra");
    extra.innerHTML="";
    if(unlocked[1] && unlocked[2] && unlocked[3] && unlocked[4]){
      const div=document.createElement("div");
      div.innerHTML='<span class="medal">é˜²è›€å°è‹±é›„ Â· å…¨é€šå…³å‹‹ç« </span><div style="font-size:13px;margin-top:6px;">è“ç™½ä¸ç²‰ç´«ä¼¢ç‰™éª‘å£«ä¸€èµ·ä¸ºä½ é¢å‘å…¨é€šå…³å‹‹ç« ï¼Œé˜²è›€å®ˆæŠ¤æ ‘ç»“å‡ºäº†â€œå…‘æ¢æœå®â€ã€‚</div>';
      extra.appendChild(div);
    }
    document.getElementById("resultOverlay").classList.add("active");
  }
  function closeResult(){
    document.getElementById("resultOverlay").classList.remove("active");
    backToHome();
  }

  // åŠ è½½åŠ¨ç”»
  function startLoading(){
    loadingInterval=setInterval(()=>{
      loadingProgress+=Math.random()*12+5;
      if(loadingProgress>100) loadingProgress=100;
      document.getElementById("loadingFill").style.width=loadingProgress+"%";
      if(loadingProgress>=100){
        clearInterval(loadingInterval);
        setTimeout(()=>{showScreen("screen-character");},400);
      }
    },260);
  }

  // å…³å¡1ï¼šç³–é…¸æ€ªå…½é€€æ•£
  function resetLevel1(){
    clearInterval(timerL1);timerL1=null;
    timeL1=60;scoreL1=0;hitCountL1=0;
    document.getElementById("timerL1").textContent=timeL1;
    document.getElementById("hitCountL1").textContent=hitCountL1;
    document.getElementById("pointsL1").textContent=yaPoints;
    document.getElementById("fieldL1").querySelectorAll(".monster,.guardian").forEach(e=>e.remove());
  }
  function startLevel1(){
    resetLevel1();
    const field=document.getElementById("fieldL1");
    timerL1=setInterval(()=>{
      timeL1--;
      document.getElementById("timerL1").textContent=timeL1;
      // ç”Ÿæˆæ•Œäººæˆ–å«å£«
      spawnTargetL1(field);
      if(timeL1<=0){
        clearInterval(timerL1);timerL1=null;
        const success=hitCountL1>=30;
                const baseReward=success? (50+Math.floor(Math.random()*21)):20;
        yaPoints+=baseReward;
        pushLog("å…³å¡1 Â· ç³–é…¸æ€ªå…½é€€æ•£", baseReward);
        if(success){unlocked[2]=true;lockLevelCard(2);}
        saveGameState();

        const msgSuccess=`å’Œ ${player.name||"ä¼¢ç‰™éª‘å£«"} ä¸€èµ·å‡»é€€äº† <strong>${hitCountL1}</strong> åªç³–é…¸æ€ªå…½ï¼Œç‰™é½¿åŸå ¡è¢«é˜²è›€æ³¡æ²«ç´§ç´§åŒ…è£¹ã€‚<br>è·å¾—æœ¬å…³ä¼¢åˆ† <strong>${baseReward}</strong> åˆ†ï¼Œå¹¶è‡ªåŠ¨ç‚¹äº®â€œé—ªå…‰ç‰™åˆ·éª‘å£«â€è·¯å¾„ã€‚`;
        const msgFail=`æœ¬æ¬¡å‡»é€€äº† <strong>${hitCountL1}</strong> åªç³–é…¸æ€ªå…½ï¼Œè¿˜å·®ä¸€ç‚¹ç‚¹å°±èƒ½å®Œå…¨å®ˆä½ç‰™é½¿åŸå ¡ï¼Œä¸‹æ¬¡å†æ¥æŒ‘æˆ˜ã€‚<br>å®‰æ…°å¥–åŠ±ä¼¢åˆ† <strong>${baseReward}</strong> åˆ†ã€‚`;
        showResult(success?"é€šå…³æˆåŠŸ Â· ç³–é…¸æ€ªå…½é€€æ•£": "æš‚æœªé€šå…³ Â· ç»§ç»­åŠ æ²¹",success?msgSuccess:msgFail);
      }
    },1000);
  }
  function spawnTargetL1(field){
    const isMonster=Math.random()<0.7;
    const div=document.createElement("div");
    div.className=isMonster?"monster":"guardian";
    div.innerHTML=isMonster?'<span>ğŸ­</span>':'<span>ğŸ›¡</span>';
    const rect=field.getBoundingClientRect();
    const x=Math.random()*(rect.width-80);
    const y=Math.random()*(rect.height-80);
    div.style.left=x+"px";div.style.top=y+"px";
    div.addEventListener("click",()=>{
      if(!timerL1) return;
      if(div.clicked) return;
      div.clicked=true;
      if(isMonster){
        hitCountL1++;
        scoreL1+=3;
        document.getElementById("hitCountL1").textContent=hitCountL1;
      }else{
        scoreL1-=5;
        const tip=document.createElement("div");
        tip.textContent="åˆ«æ‰“è‡ªå·±äºº~";
        tip.style.position="absolute";tip.style.top="-18px";tip.style.fontSize="11px";
        div.appendChild(tip);
        setTimeout(()=>tip.remove(),700);
      }
      div.style.transform="scale(.6)";
      setTimeout(()=>div.remove(),150);
    });
    field.appendChild(div);
    setTimeout(()=>{if(!div.clicked)div.remove();},900);
  }

  // å…³å¡2ï¼šåˆ·ç‰™æ¯”èµ›
  function buildTeeth(){
    const grid=document.getElementById("teethGrid");
    grid.innerHTML="";
    totalTeeth=18;
    for(let i=0;i<totalTeeth;i++){
      const tooth=document.createElement("div");
      tooth.className="tooth";
      tooth.dataset.clean="0";
      tooth.addEventListener("click",()=>{
        if(!timerL2) return;
        let clean=parseInt(tooth.dataset.clean,10);
        if(clean<2) clean++;
        tooth.dataset.clean=clean;
        if(clean>=2 && !tooth.classList.contains("clean")){
          tooth.classList.add("clean");
          cleanCount++;
          updateScoreL2();
        }
      });
      grid.appendChild(tooth);
    }
  }
  function resetLevel2(){
    clearInterval(timerL2);timerL2=null;
    timeL2=60;cleanCount=0;
    document.getElementById("timerL2").textContent=timeL2;
    document.getElementById("scoreL2").textContent="0";
    buildTeeth();
  }
  function updateScoreL2(){
    const percent=Math.round(cleanCount/totalTeeth*100);
    document.getElementById("scoreL2").textContent=percent;
  }
  function startLevel2(){
    resetLevel2();
    timerL2=setInterval(()=>{
      timeL2--;
      document.getElementById("timerL2").textContent=timeL2;
      if(timeL2<=0){
        clearInterval(timerL2);timerL2=null;
        const percent=Math.round(cleanCount/totalTeeth*100);
                const baseReward=percent>=85?(80+Math.floor(Math.random()*31)):(40+Math.floor(Math.random()*21));
        yaPoints+=baseReward;
        pushLog("å…³å¡2 Â· é—ªå…‰ç‰™åˆ·éª‘å£«", baseReward);
        let msg;

        if(percent>=85){
          unlocked[3]=true;lockLevelCard(3);
          msg=`ä½ çš„åˆ·ç‰™æ¸…æ´åº¦è¾¾åˆ° <strong>${percent}</strong> åˆ†ï¼Œä¼¢ç‰™éª‘å£«å˜èº«ä¸ºâ€œé—ªå…‰å½¢æ€â€ï¼Œè·å¾—â€œé˜²è›€å°è¾¾äººâ€å‹‹ç« ï¼Œå¹¶é¢å¤–å¾—åˆ°ä¼¢åˆ† <strong>${baseReward}</strong> åˆ†ï¼ŒåŒæ—¶è§£é”â€œæ‹¼å›¾å¯»å®è®°â€ã€‚<div class="medal" style="margin-top:6px;">é˜²è›€å°è¾¾äºº</div>`;
        }else{
          msg=`æœ¬æ¬¡æ¸…æ´åº¦ä¸º <strong>${percent}</strong> åˆ†ï¼Œéƒ¨åˆ†åŒºåŸŸè¿˜æœ‰å°è›€æ–‘ï¼Œä¼¢ç‰™éª‘å£«æ¸©æŸ”æé†’ä¸‹æ¬¡å¤šç…§é¡¾åˆ°ç‰™ç¼å’Œé é‡Œçš„ç‰™é½¿ã€‚<br>è·å¾—ä¼¢åˆ† <strong>${baseReward}</strong> åˆ†ã€‚`;
        }
                saveGameState();
        showResult("å…³å¡ç»“æœ Â· é—ªå…‰ç‰™åˆ·éª‘å£«",msg);
      }
    },1000);
  }

  // å…³å¡3ï¼šæ‹¼å›¾
  function resetLevel3(){
    clearInterval(timerL3);timerL3=null;
    timeL3=0;stepsL3=0;
    document.getElementById("timeL3").textContent=timeL3;
    document.getElementById("stepsL3").textContent=stepsL3;
    buildPuzzle();
  }
  function buildPuzzle(){
    const grid=document.getElementById("puzzleGrid");
    grid.innerHTML="";
    puzzleState=[1,2,3,null];
    // ç®€å•æ‰“ä¹±
    for(let i=puzzleState.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [puzzleState[i],puzzleState[j]]=[puzzleState[j],puzzleState[i]];
    }
    puzzleState.forEach((val,idx)=>{
      const tile=document.createElement("div");
      tile.dataset.index=idx;
      if(val===null){tile.className="puzzle-tile empty";}
      else{
        tile.className="puzzle-tile";
        tile.textContent=val;
        tile.addEventListener("click",()=>moveTile(idx));
      }
      grid.appendChild(tile);
    });
  }
  function moveTile(index){
    if(!timerL3) return;
    const emptyIndex=puzzleState.indexOf(null);
    const neighbors=[emptyIndex-1,emptyIndex+1,emptyIndex-3,emptyIndex+3];
    if(!neighbors.includes(index)) return;
    [puzzleState[index],puzzleState[emptyIndex]]=[puzzleState[emptyIndex],puzzleState[index]];
    stepsL3++;
    document.getElementById("stepsL3").textContent=stepsL3;
    renderPuzzle();
    checkPuzzleComplete();
  }
  function renderPuzzle(){
    const grid=document.getElementById("puzzleGrid");
    Array.from(grid.children).forEach((tile,idx)=>{
      const val=puzzleState[idx];
      tile.dataset.index=idx;
      if(val===null){
        tile.className="puzzle-tile empty";
        tile.textContent="";
        tile.onclick=null;
      }else{
        tile.className="puzzle-tile";
        tile.textContent=val;
        tile.onclick=()=>moveTile(idx);
      }
    });
  }
  function checkPuzzleComplete(){
    const complete=[1,2,3,null];
    for(let i=0;i<complete.length;i++){
      if(puzzleState[i]!==complete[i]) return;
    }
    clearInterval(timerL3);timerL3=null;
    const baseReward=60+Math.max(0,40-Math.floor(timeL3/2));
    yaPoints+=baseReward;
    pushLog("å…³å¡3 Â· æ‹¼å›¾å¯»å®è®°", baseReward);
    unlocked[4]=true;lockLevelCard(4);
    saveGameState();
    const msg=`ä½ åœ¨ <strong>${timeL3}</strong> ç§’å†…ï¼Œç”¨ <strong>${stepsL3}</strong> æ­¥å®Œæˆäº†ä¼¢ç‰™ä¹åŒéª‘å£«æ‹¼å›¾ï¼ŒæˆåŠŸæ‰¾åˆ°éšè—å®è—ï¼Œè·å¾—ä¼¢åˆ† <strong>${baseReward}</strong> åˆ†ï¼Œå¹¶è§£é”â€œç¬‘å®¹åˆ›æ„å·¥åŠâ€ã€‚<br><span class="medal">å®è—æ”¶è—å®¶</span>`;
    showResult("é€šå…³æˆåŠŸ Â· æ‹¼å›¾å¯»å®è®°",msg);
  }
  function startLevel3(){
    resetLevel3();
    timerL3=setInterval(()=>{
      timeL3++;
      document.getElementById("timeL3").textContent=timeL3;
    },1000);
  }

  // å…³å¡4ï¼šç¬‘å®¹åˆ›æ„å·¥åŠ
  function resetLevel4(){
    document.getElementById("pointsL4").textContent=yaPoints;
  }
  function handlePhotoUpload(evt){
    const file=evt.target.files[0];
    if(!file) return;
    const reader=new FileReader();
    reader.onload=e=>{
      let img=document.querySelector("#posterArea img");
      const poster=document.getElementById("posterArea");
      document.getElementById("posterPlaceholder").style.display="none";
      if(!img){
        img=document.createElement("img");
        poster.appendChild(img);
      }
      img.src=e.target.result;
    };
    reader.readAsDataURL(file);
  }
  function addSticker(type){
    const poster=document.getElementById("posterArea");
    const sticker=document.createElement("div");
    sticker.className="sticker "+type;
    sticker.textContent=type==="boy"?"è“ç™½éª‘å£«":type==="girl"?"ç²‰ç´«éª‘å£«":"é˜²è›€ç¬‘å®¹";
    const rect=poster.getBoundingClientRect();
    const x=Math.random()*(rect.width-90)+10;
    const y=Math.random()*(rect.height-90)+10;
    sticker.style.left=x+"px";sticker.style.top=y+"px";
    sticker.addEventListener("pointerdown",e=>{
      draggingSticker=sticker;
      dragOffsetX=e.clientX-sticker.offsetLeft;
      dragOffsetY=e.clientY-sticker.offsetTop;
      sticker.setPointerCapture(e.pointerId);
    });
    sticker.addEventListener("pointerup",e=>{
      draggingSticker=null;
      sticker.releasePointerCapture(e.pointerId);
    });
    sticker.addEventListener("pointermove",e=>{
      if(draggingSticker!==sticker) return;
      const rectPoster=poster.getBoundingClientRect();
      let nx=e.clientX-dragOffsetX;
      let ny=e.clientY-dragOffsetY;
      nx=Math.max(0,Math.min(rectPoster.width-80,nx));
      ny=Math.max(0,Math.min(rectPoster.height-80,ny));
      sticker.style.left=nx+"px";sticker.style.top=ny+"px";
    });
    poster.appendChild(sticker);
  }
  function finishPoster(){
    const reward=100+Math.floor(Math.random()*51);
    yaPoints+=reward;
    pushLog("å…³å¡4 Â· é˜²è›€ç¬‘å®¹æµ·æŠ¥", reward);
    saveGameState();
    const msg=`ä½ å·²ç»å®Œæˆäº†ä¸€å¼ ä¸“å±â€œé˜²è›€ç¬‘å®¹æµ·æŠ¥â€ï¼Œä¼¢ç‰™éª‘å£«å‡ºç°åœ¨æµ·æŠ¥è§’è½ï¼Œä¸ºè¿™å¼ äº²å­éœ²é½¿ç¬‘å¤§å£°ç‚¹èµã€‚<br>é˜²è›€å®ˆæŠ¤æ ‘å®Œå…¨å¼€èŠ±ç»“æœï¼Œè·å¾—ä¼¢åˆ† <strong>${reward}</strong> åˆ†ã€‚`;
    showResult("å®Œæˆåˆ›ä½œ Â· é˜²è›€ç¬‘å®¹æµ·æŠ¥",msg);
  }

  // åˆå§‹åŒ–å’Œäº‹ä»¶ç»‘å®š
    document.addEventListener("DOMContentLoaded",()=>{
    // å…ˆæ¢å¤æœ¬åœ°å­˜æ¡£å’Œä¼¢åˆ†æ˜ç»†
    loadGameState();
    loadLog();

    startLoading();

    // åˆå§‹åŒ–ä»Šæ—¥ç­¾åˆ°çŠ¶æ€ï¼ˆå¦‚æœå­˜æ¡£é‡Œæ²¡å†™ï¼Œå°±å†å•ç‹¬åˆ¤æ–­ä¸€æ¬¡ï¼‰
    const todayKey = getTodayKey();
    const signedDate = localStorage.getItem("ya_island_signed_date");
    hasSignedToday = signedDate === todayKey;

    // è§’è‰²é€‰æ‹©
    const cardBoy=document.getElementById("cardBoy");
    const cardGirl=document.getElementById("cardGirl");
    cardBoy.addEventListener("click",()=>{
      player.character="boy";
      cardBoy.classList.add("selected");
      cardGirl.classList.remove("selected");
    });
    cardGirl.addEventListener("click",()=>{
      player.character="girl";
      cardGirl.classList.add("selected");
      cardBoy.classList.remove("selected");
    });
    document.getElementById("btnRandomName").addEventListener("click",()=>{
      const name=randomNickname();
      document.getElementById("nickname").value=name;
    });

        document.getElementById("btnEnterIsland").addEventListener("click",()=>{
      const input=document.getElementById("nickname");
      player.name=input.value.trim()||randomNickname();
      input.value=player.name;
      lockLevelCard(1);lockLevelCard(2);lockLevelCard(3);lockLevelCard(4);
      saveGameState();
      pushLog("åˆ›å»ºé˜²è›€éª‘å£«", 0);
      showScreen("screen-home");
    });

    // åœ°å›¾å…¥å£
    document.getElementById("btnLevel1").addEventListener("click",()=>{
      showScreen("screen-level1");
      resetLevel1();
    });
    document.getElementById("btnLevel2").addEventListener("click",()=>{
      if(!unlocked[2]){openGenericDialog("å…³å¡å°šæœªè§£é”","å…ˆå®Œæˆâ€œç³–é…¸æ€ªå…½é€€æ•£â€å…³å¡ï¼Œæ‰èƒ½ç‚¹äº®â€œé—ªå…‰ç‰™åˆ·éª‘å£«â€çš„é“è·¯ã€‚");return;}
      showScreen("screen-level2");
      resetLevel2();
    });
    document.getElementById("btnLevel3").addEventListener("click",()=>{
      if(!unlocked[3]){openGenericDialog("å…³å¡å°šæœªè§£é”","å…ˆåœ¨â€œé—ªå…‰ç‰™åˆ·éª‘å£«â€å…³å¡æ‹¿åˆ°åˆæ ¼æ¸…æ´åº¦ï¼Œå†å¼€å¯â€œæ‹¼å›¾å¯»å®è®°â€ã€‚");return;}
      showScreen("screen-level3");
      resetLevel3();
    });
    document.getElementById("btnLevel4").addEventListener("click",()=>{
      if(!unlocked[4]){openGenericDialog("å…³å¡å°šæœªè§£é”","å…ˆå®Œæˆâ€œæ‹¼å›¾å¯»å®è®°â€ï¼Œæ‰¾åˆ°ä¼¢ç‰™ä¹å®è—åï¼Œæ‰èƒ½è¿›å…¥ç¬‘å®¹åˆ›æ„å·¥åŠã€‚");return;}
      showScreen("screen-level4");
      resetLevel4();
    });
    // â˜… æ–°å¢ï¼šè¿”å›åˆ›å»ºè§’è‰²æŒ‰é’®
  document.getElementById("btnBackToCreator").addEventListener("click", () =>
 {
    showScreen("screen-character"
);
  });

      document.getElementById("btnReset").addEventListener("click", resetGameState);

    // ç­¾åˆ°/ä¸ªäººä¸­å¿ƒ/å•†åŸ
        document.getElementById("btnSignin").addEventListener("click", () => {
      const todayKey = getTodayKey();

      // å¦‚æœä»Šå¤©å·²ç»ç­¾è¿‡åˆ°ï¼šä¸å†åŠ åˆ†ï¼Œåªæç¤ºæ–‡æ¡ˆ
      if (hasSignedToday && localStorage.getItem("ya_island_signed_date") === todayKey) {
        openGenericDialog("æ¯æ—¥ç­¾åˆ°", "ä»Šæ—¥å·²ç­¾åˆ°ï¼Œæ˜æ—¥å†æ¥å§~");
        return;
      }

      // ç¬¬ä¸€æ¬¡ç­¾åˆ°ï¼šåŠ åˆ† + è®°å½•æ—¥æœŸ + åˆ·æ–° HUD
            const reward = 10;
      yaPoints += reward;
      hasSignedToday = true;
      localStorage.setItem("ya_island_signed_date", todayKey);

      pushLog("æ¯æ—¥ç­¾åˆ°", reward);
      saveGameState();
      updateHUD();

      openGenericDialog(

        "æ¯æ—¥ç­¾åˆ°æˆåŠŸ",
        "ä»Šæ—¥å·²ç­¾åˆ°ï¼Œç‰™é½¿åŸå ¡ä¸ºä½ äº®èµ·ä¸€ç›å°ç¯ï¼Œè·å¾—ä¼¢åˆ† " + reward + " åˆ†ã€‚"
      );
    });

        document.getElementById("btnProfile").addEventListener("click",()=>{
  loadLog();
  const baseInfo = "æ˜µç§°ï¼š" + (player.name || "é˜²è›€éª‘å£«") + "ï¼›å½“å‰ä¼¢åˆ†ï¼š" + yaPoints + "ã€‚";
  const lines = pointLog.map(
    item => `${item.time} Â· ${item.reason} +${item.delta}åˆ†`
  );
  const detail = lines.length
    ? ("\n\nä¼¢åˆ†æ˜ç»†ï¼š\n" + lines.join("\n"))
    : "\n\næš‚æ—¶è¿˜æ²¡æœ‰ä¼¢åˆ†è®°å½•~";

  openGenericDialog("ä¸ªäººä¸­å¿ƒ", baseInfo + detail);
});


    document.getElementById("btnShop").addEventListener("click",()=>{
      openGenericDialog("å…‘æ¢å•†åŸ","å…‘æ¢æ± ç¤ºä¾‹ï¼š\nÂ· 300ä¼¢åˆ†ï¼šä¼¢ç‰™ä¹è“ç™½éª‘å£«é’¥åŒ™æ‰£\nÂ· 500ä¼¢åˆ†ï¼šåŒéª‘å£«Qç‰ˆæ‰‹åŠ\nÂ· 800ä¼¢åˆ†ï¼šäº²å­é˜²è›€ç¤¼åŒ…\nå¯ä»¥æ ¹æ®æ´»åŠ¨å®é™…é…ç½®è°ƒæ•´ã€‚");
    });
    document.getElementById("btnDialogOk").addEventListener("click",closeGenericDialog);
    // å…³å¡1æŒ‰é’®
    document.getElementById("btnStartL1").addEventListener("click",startLevel1);
    // å…³å¡2æŒ‰é’®
    document.getElementById("btnStartL2").addEventListener("click",startLevel2);
    // å…³å¡3æŒ‰é’®
    document.getElementById("btnStartL3").addEventListener("click",startLevel3);
    // å…³å¡4
    document.getElementById("photoInput").addEventListener("change",handlePhotoUpload);
    document.getElementById("btnStickerBoy").addEventListener("click",()=>addSticker("boy"));
    document.getElementById("btnStickerGirl").addEventListener("click",()=>addSticker("girl"));
    document.getElementById("btnStickerHeart").addEventListener("click",()=>addSticker("heart"));
    document.getElementById("btnFinishPoster").addEventListener("click",finishPoster);
    // ç»“æœæµ®å±‚
    document.getElementById("btnResultBack").addEventListener("click",closeResult);
  });
</script>
</body>
</html>
